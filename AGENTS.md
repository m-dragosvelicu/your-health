# Repository Guidelines

## Project Structure & Module Organization
This Next.js App Router project keeps UI entrypoints in `src/app`, with server components such as `page.tsx` and client widgets under `src/app/_components`. API handlers live in `src/app/api`, while backend logic sits in `src/server`: `api/` holds tRPC routers (`root.ts`, `routers/post.ts`), `auth/` configures NextAuth, and `db.ts` exposes the Prisma client. Shared tRPC clients are in `src/trpc`, global styles in `src/styles/globals.css`, and environment parsing in `src/env.js`. Persisted models live in `prisma/schema.prisma`; static assets belong in `public/`. Use `start-database.sh` when you need a disposable Postgres container.

## Build, Test, and Development Commands
- `npm install` – install Node.js 20+ dependencies and generate the Prisma client.
- `npm run dev` – start the Next dev server (http://localhost:3000) with hot reload and tRPC.
- `./start-database.sh` – spin up a local Postgres using the current `DATABASE_URL`.
- `npm run db:generate` / `npm run db:push` – create migrations or sync schema for Prisma.
- `npm run check` – run ESLint plus TypeScript `--noEmit` for a quick sanity gate.
- `npm run build` then `npm run preview` – verify production output before shipping.

## Coding Style & Naming Conventions
Code is TypeScript-first with ES modules. Prefer server components by default; suffix client components with "use client" and group them under `src/app/_components`. Name files and folders in `kebab-case`, exported React components in `PascalCase`, and utilities in `camelCase`. Prettier (with the Tailwind plugin) owns formatting—run `npm run format:write` before committing. The ESLint config enforces inline `type` imports and flags unused symbols unless prefixed with `_`. Keep Tailwind classes sorted by Prettier, and co-locate procedure logic next to the matching tRPC router.

## Testing Guidelines
A formal unit test harness is not yet wired up. Until one is introduced, every change must pass `npm run check` and include manual verification steps in the PR description. If you add automated tests, co-locate `*.test.ts` files beside the feature, wire the runner into `package.json`, and document the new command here. Database-affecting changes should include a migration plus a seed or reproduction snippet.

## Commit & Pull Request Guidelines
Write commit subjects in the imperative mood (e.g., `Add post form validation`), limit them to ~72 characters, and use additional body lines for motivation or breaking changes. Reference issues with `#id` when relevant. Each PR should: explain the change and the user-facing impact, call out environment or schema updates, attach screenshots for UI work, list manual test steps, and ensure CI-friendly commands (`npm run check`, `npm run build`) succeed locally.

## Security & Configuration Tips
Never commit `.env`; instead copy from `.env.example` if you add new variables and document defaults in `src/env.js`. Secrets are validated via `@t3-oss/env-nextjs`; use `SKIP_ENV_VALIDATION=1` only for Docker workflows. Rotate database passwords generated by `start-database.sh`, and revoke unused OAuth credentials promptly.
